<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>User guide · AbstractDifferentiation.jl</title><meta name="title" content="User guide · AbstractDifferentiation.jl"/><meta property="og:title" content="User guide · AbstractDifferentiation.jl"/><meta property="twitter:title" content="User guide · AbstractDifferentiation.jl"/><meta name="description" content="Documentation for AbstractDifferentiation.jl."/><meta property="og:description" content="Documentation for AbstractDifferentiation.jl."/><meta property="twitter:description" content="Documentation for AbstractDifferentiation.jl."/><meta property="og:url" content="https://JuliaDiff.github.io/AbstractDifferentiation.jl/user_guide/"/><meta property="twitter:url" content="https://JuliaDiff.github.io/AbstractDifferentiation.jl/user_guide/"/><link rel="canonical" href="https://JuliaDiff.github.io/AbstractDifferentiation.jl/user_guide/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">AbstractDifferentiation.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>User guide</a><ul class="internal"><li><a class="tocitem" href="#Loading-AbstractDifferentiation"><span>Loading <code>AbstractDifferentiation</code></span></a></li><li><a class="tocitem" href="#AbstractDifferentiation-backends"><span><code>AbstractDifferentiation</code> backends</span></a></li><li><a class="tocitem" href="#Derivatives"><span>Derivatives</span></a></li><li><a class="tocitem" href="#Value-and-derivatives"><span>Value and derivatives</span></a></li><li><a class="tocitem" href="#Jacobian-vector-products"><span>Jacobian-vector products</span></a></li><li><a class="tocitem" href="#Vector-Jacobian-products"><span>Vector-Jacobian products</span></a></li><li><a class="tocitem" href="#Lazy-operators"><span>Lazy operators</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li><li><a class="tocitem" href="../implementer_guide/">Implementer guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>User guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>User guide</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/master/docs/src/user_guide.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="User-guide"><a class="docs-heading-anchor" href="#User-guide">User guide</a><a id="User-guide-1"></a><a class="docs-heading-anchor-permalink" href="#User-guide" title="Permalink"></a></h1><p>The list of functions on this page is the officially supported differentiation interface in <code>AbstractDifferentiation</code>.</p><h2 id="Loading-AbstractDifferentiation"><a class="docs-heading-anchor" href="#Loading-AbstractDifferentiation">Loading <code>AbstractDifferentiation</code></a><a id="Loading-AbstractDifferentiation-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-AbstractDifferentiation" title="Permalink"></a></h2><p>To load <code>AbstractDifferentiation</code>, it is recommended to use</p><pre><code class="language-julia hljs">import AbstractDifferentiation as AD</code></pre><p>With the <code>AD</code> alias you can access names inside of <code>AbstractDifferentiation</code> using <code>AD.&lt;&gt;</code> instead of typing the long name <code>AbstractDifferentiation</code>.</p><h2 id="AbstractDifferentiation-backends"><a class="docs-heading-anchor" href="#AbstractDifferentiation-backends"><code>AbstractDifferentiation</code> backends</a><a id="AbstractDifferentiation-backends-1"></a><a class="docs-heading-anchor-permalink" href="#AbstractDifferentiation-backends" title="Permalink"></a></h2><p>To use <code>AbstractDifferentiation</code>, first construct a backend instance <code>ab::AD.AbstractBackend</code> using your favorite differentiation package in Julia that supports <code>AbstractDifferentiation</code>.</p><p>Here&#39;s an example:</p><pre><code class="language-julia-repl hljs">julia&gt; import AbstractDifferentiation as AD, Zygote

julia&gt; backend = AD.ZygoteBackend();

julia&gt; f(x) = log(sum(exp, x));

julia&gt; AD.gradient(backend, f, collect(1:3))
([0.09003057317038046, 0.2447284710547977, 0.665240955774822],)</code></pre><p>The following backends are temporarily made available by <code>AbstractDifferentiation</code> as soon as their corresponding package is loaded (thanks to <a href="https://pkgdocs.julialang.org/dev/creating-packages/#Weak-dependencies">weak dependencies</a> on Julia ≥ 1.9 and <a href="https://github.com/JuliaPackaging/Requires.jl">Requires.jl</a> on older Julia versions):</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.ReverseDiffBackend" href="#AbstractDifferentiation.ReverseDiffBackend"><code>AbstractDifferentiation.ReverseDiffBackend</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReverseDiffBackend</code></pre><p>AD backend that uses reverse mode with <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To be able to use this backend, you have to load ReverseDiff.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/backends.jl#L30-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.ReverseRuleConfigBackend" href="#AbstractDifferentiation.ReverseRuleConfigBackend"><code>AbstractDifferentiation.ReverseRuleConfigBackend</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReverseRuleConfigBackend</code></pre><p>AD backend that uses reverse mode with any <a href="https://github.com/JuliaDiff/ChainRulesCore.jl">ChainRulesCore.jl</a>-compatible reverse-mode AD package.</p><p>Constructed with a <a href="https://juliadiff.org/ChainRulesCore.jl/stable/rule_author/superpowers/ruleconfig.html"><code>RuleConfig</code></a> object:</p><pre><code class="language-julia hljs">backend = AD.ReverseRuleConfigBackend(rc)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>On Julia &gt;= 1.9, you have to load ChainRulesCore (possibly implicitly by loading a ChainRules-compatible AD package) to be able to use this backend.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/backends.jl#L50-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.FiniteDifferencesBackend" href="#AbstractDifferentiation.FiniteDifferencesBackend"><code>AbstractDifferentiation.FiniteDifferencesBackend</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FiniteDifferencesBackend{M}</code></pre><p>AD backend that uses forward mode with <a href="https://github.com/JuliaDiff/FiniteDifferences.jl">FiniteDifferences.jl</a>.</p><p>The type parameter <code>M</code> is the type of the method used to perform finite differences.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To be able to use this backend, you have to load FiniteDifferences.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/backends.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.ZygoteBackend" href="#AbstractDifferentiation.ZygoteBackend"><code>AbstractDifferentiation.ZygoteBackend</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ZygoteBackend()</code></pre><p>Create an AD backend that uses reverse mode with <a href="https://github.com/FluxML/Zygote.jl">Zygote.jl</a>.</p><p>It is a special case of <a href="#AbstractDifferentiation.ReverseRuleConfigBackend"><code>ReverseRuleConfigBackend</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To be able to use this backend, you have to load Zygote.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/backends.jl#L73-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.ForwardDiffBackend" href="#AbstractDifferentiation.ForwardDiffBackend"><code>AbstractDifferentiation.ForwardDiffBackend</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ForwardDiffBackend{CS}</code></pre><p>AD backend that uses forward mode with <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>.</p><p>The type parameter <code>CS</code> denotes the chunk size of the differentiation algorithm.  If it is <code>Nothing</code>, then ForwardiffDiff uses a heuristic to set the chunk size based on the input.</p><p>See also: <a href="https://juliadiff.org/ForwardDiff.jl/dev/user/advanced/#Configuring-Chunk-Size">ForwardDiff.jl: Configuring Chunk Size</a></p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To be able to use this backend, you have to load ForwardDiff.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/backends.jl#L15-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.TrackerBackend" href="#AbstractDifferentiation.TrackerBackend"><code>AbstractDifferentiation.TrackerBackend</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">TrackerBackend</code></pre><p>AD backend that uses reverse mode with <a href="https://github.com/FluxML/Tracker.jl">Tracker.jl</a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To be able to use this backend, you have to load Tracker.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/backends.jl#L40-L47">source</a></section></article><p>In the long term, these backend objects (and many more) will be defined within their respective packages to enforce the <code>AbstractDifferentiation</code> interface. This is already the case for:</p><ul><li><code>Diffractor.DiffractorForwardBackend()</code> for <a href="https://github.com/JuliaDiff/Diffractor.jl">Diffractor.jl</a> in forward mode</li></ul><p>For higher order derivatives, you can build higher order backends using <code>AD.HigherOrderBackend</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.HigherOrderBackend" href="#AbstractDifferentiation.HigherOrderBackend"><code>AbstractDifferentiation.HigherOrderBackend</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AD.HigherOrderBackend{B}</code></pre><p>Let <code>ab_f</code> be a forward-mode automatic differentiation backend and let <code>ab_r</code> be a reverse-mode automatic differentiation backend. To construct a higher order backend for doing forward-over-reverse-mode automatic differentiation, use <code>AD.HigherOrderBackend((ab_f, ab_r))</code>. To construct a higher order backend for doing reverse-over-forward-mode automatic differentiation, use <code>AD.HigherOrderBackend((ab_r, ab_f))</code>.</p><p><strong>Fields</strong></p><ul><li><code>backends::B</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L10-L20">source</a></section></article><h2 id="Derivatives"><a class="docs-heading-anchor" href="#Derivatives">Derivatives</a><a id="Derivatives-1"></a><a class="docs-heading-anchor-permalink" href="#Derivatives" title="Permalink"></a></h2><p>The following list of functions can be used to request the derivative, gradient, Jacobian, second derivative or Hessian without the function value.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.derivative" href="#AbstractDifferentiation.derivative"><code>AbstractDifferentiation.derivative</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.derivative(ab::AD.AbstractBackend, f, xs::Number...)</code></pre><p>Compute the derivatives of <code>f</code> with respect to the numbers <code>xs</code> using the backend <code>ab</code>.</p><p>The function returns a <code>Tuple</code> of derivatives, one for each element in <code>xs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L48-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.gradient" href="#AbstractDifferentiation.gradient"><code>AbstractDifferentiation.gradient</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.gradient(ab::AD.AbstractBackend, f, xs...)</code></pre><p>Compute the gradients of <code>f</code> with respect to the inputs <code>xs</code> using the backend <code>ab</code>.</p><p>The function returns a <code>Tuple</code> of gradients, one for each element in <code>xs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L64-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.jacobian" href="#AbstractDifferentiation.jacobian"><code>AbstractDifferentiation.jacobian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.jacobian(ab::AD.AbstractBackend, f, xs...)</code></pre><p>Compute the Jacobians of <code>f</code> with respect to the inputs <code>xs</code> using the backend <code>ab</code>.</p><p>The function returns a <code>Tuple</code> of Jacobians, one for each element in <code>xs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L75-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.second_derivative" href="#AbstractDifferentiation.second_derivative"><code>AbstractDifferentiation.second_derivative</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.second_derivative(ab::AD.AbstractBackend, f, x)</code></pre><p>Compute the second derivative of <code>f</code> with respect to the input <code>x</code> using the backend <code>ab</code>.</p><p>The function returns a single value because <code>second_derivative</code> currently only supports a single input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L88-L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.hessian" href="#AbstractDifferentiation.hessian"><code>AbstractDifferentiation.hessian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.hessian(ab::AD.AbstractBackend, f, x)</code></pre><p>Compute the Hessian of <code>f</code> wrt the input <code>x</code> using the backend <code>ab</code>.</p><p>The function returns a single matrix because <code>hessian</code> currently only supports a single input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L106-L112">source</a></section></article><h2 id="Value-and-derivatives"><a class="docs-heading-anchor" href="#Value-and-derivatives">Value and derivatives</a><a id="Value-and-derivatives-1"></a><a class="docs-heading-anchor-permalink" href="#Value-and-derivatives" title="Permalink"></a></h2><p>The following list of functions can be used to request the function value along with its derivative, gradient, Jacobian, second derivative, or Hessian. You can also request the function value, its derivative (or its gradient) and its second derivative (or Hessian) for single-input functions.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.value_and_derivative" href="#AbstractDifferentiation.value_and_derivative"><code>AbstractDifferentiation.value_and_derivative</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.value_and_derivative(ab::AD.AbstractBackend, f, xs::Number...)</code></pre><p>Return the tuple <code>(v, ds)</code> of the function value <code>v = f(xs...)</code> and the derivatives <code>ds = AD.derivative(ab, f, xs...)</code>.</p><p>See also <a href="#AbstractDifferentiation.derivative"><code>AbstractDifferentiation.derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L123-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.value_and_gradient" href="#AbstractDifferentiation.value_and_gradient"><code>AbstractDifferentiation.value_and_gradient</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.value_and_gradient(ab::AD.AbstractBackend, f, xs...)</code></pre><p>Return the tuple <code>(v, gs)</code> of the function value <code>v = f(xs...)</code> and the gradients <code>gs = AD.gradient(ab, f, xs...)</code>.</p><p>See also <a href="#AbstractDifferentiation.gradient"><code>AbstractDifferentiation.gradient</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L135-L141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.value_and_jacobian" href="#AbstractDifferentiation.value_and_jacobian"><code>AbstractDifferentiation.value_and_jacobian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.value_and_jacobian(ab::AD.AbstractBackend, f, xs...)</code></pre><p>Return the tuple <code>(v, Js)</code> of the function value <code>v = f(xs...)</code> and the Jacobians <code>Js = AD.jacobian(ab, f, xs...)</code>.</p><p>See also <a href="#AbstractDifferentiation.jacobian"><code>AbstractDifferentiation.jacobian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L147-L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.value_and_second_derivative" href="#AbstractDifferentiation.value_and_second_derivative"><code>AbstractDifferentiation.value_and_second_derivative</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.value_and_second_derivative(ab::AD.AbstractBackend, f, x)</code></pre><p>Return the tuple <code>(v, d2)</code> of the function value <code>v = f(x)</code> and the second derivative <code>d2 = AD.second_derivative(ab, f, x)</code>.</p><p>See also <a href="#AbstractDifferentiation.second_derivative"><code>AbstractDifferentiation.second_derivative</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L160-L166">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.value_and_hessian" href="#AbstractDifferentiation.value_and_hessian"><code>AbstractDifferentiation.value_and_hessian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.value_and_hessian(ab::AD.AbstractBackend, f, x)</code></pre><p>Return the tuple <code>(v, H)</code> of the function value <code>v = f(x)</code> and the Hessian <code>H = AD.hessian(ab, f, x)</code>.</p><p>See also <a href="#AbstractDifferentiation.hessian"><code>AbstractDifferentiation.hessian</code></a>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L171-L177">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.value_derivative_and_second_derivative" href="#AbstractDifferentiation.value_derivative_and_second_derivative"><code>AbstractDifferentiation.value_derivative_and_second_derivative</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.value_derivative_and_second_derivative(ab::AD.AbstractBackend, f, x)</code></pre><p>Return the tuple <code>(v, d, d2)</code> of the function value <code>v = f(x)</code>, the first derivative <code>d = AD.derivative(ab, f, x)</code>, and the second derivative <code>d2 = AD.second_derivative(ab, f, x)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L193-L197">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.value_gradient_and_hessian" href="#AbstractDifferentiation.value_gradient_and_hessian"><code>AbstractDifferentiation.value_gradient_and_hessian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.value_gradient_and_hessian(ab::AD.AbstractBackend, f, x)</code></pre><p>Return the tuple <code>(v, g, H)</code> of the function value <code>v = f(x)</code>, the gradient <code>g = AD.gradient(ab, f, x)</code>, and the Hessian <code>H = AD.hessian(ab, f, x)</code>.</p><p>See also <a href="#AbstractDifferentiation.gradient"><code>AbstractDifferentiation.gradient</code></a> and <a href="#AbstractDifferentiation.hessian"><code>AbstractDifferentiation.hessian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L215-L221">source</a></section></article><h2 id="Jacobian-vector-products"><a class="docs-heading-anchor" href="#Jacobian-vector-products">Jacobian-vector products</a><a id="Jacobian-vector-products-1"></a><a class="docs-heading-anchor-permalink" href="#Jacobian-vector-products" title="Permalink"></a></h2><p>This operation goes by a few names, like &quot;pushforward&quot;. Refer to the <a href="https://juliadiff.org/ChainRulesCore.jl/stable/#The-propagators:-pushforward-and-pullback">ChainRules documentation</a> for more on terminology. For a single input, single output function <code>f</code> with a Jacobian <code>J</code>, the pushforward operator <code>pf_f</code> is equivalent to applying the function <code>v -&gt; J * v</code> on a (tangent) vector <code>v</code>.</p><p>The following functions can be used to request a function that returns the pushforward operator/function. In order to request the pushforward function <code>pf_f</code> of a function <code>f</code> at the inputs <code>xs</code>, you can use either of:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.pushforward_function" href="#AbstractDifferentiation.pushforward_function"><code>AbstractDifferentiation.pushforward_function</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.pushforward_function(ab::AD.AbstractBackend, f, xs...)</code></pre><p>Return the pushforward function <code>pff</code> of the function <code>f</code> at the inputs <code>xs</code> using backend <code>ab</code>. </p><p>The pushfoward function <code>pff</code> accepts as input a <code>Tuple</code> of tangents, one for each element in <code>xs</code>. If <code>xs</code> consists of a single element, <code>pff</code> can also accept a single tangent instead of a 1-tuple.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L239-L246">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.value_and_pushforward_function" href="#AbstractDifferentiation.value_and_pushforward_function"><code>AbstractDifferentiation.value_and_pushforward_function</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.value_and_pushforward_function(ab::AD.AbstractBackend, f, xs...)</code></pre><p>Return a single function <code>vpff</code> which, given tangents <code>ts</code>, computes the tuple <code>(v, p) = vpff(ts)</code> composed of</p><ul><li>the function value <code>v = f(xs...)</code></li><li>the pushforward value <code>p = pff(ts)</code> given by the pushforward function <code>pff = AD.pushforward_function(ab, f, xs...)</code> applied to <code>ts</code>.</li></ul><p>See also <a href="#AbstractDifferentiation.pushforward_function"><code>AbstractDifferentiation.pushforward_function</code></a>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This name should be understood as &quot;(value and pushforward) function&quot;, and thus is not aligned with the reverse mode counterpart <a href="#AbstractDifferentiation.value_and_pullback_function"><code>AbstractDifferentiation.value_and_pullback_function</code></a>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L264-L276">source</a></section></article><h2 id="Vector-Jacobian-products"><a class="docs-heading-anchor" href="#Vector-Jacobian-products">Vector-Jacobian products</a><a id="Vector-Jacobian-products-1"></a><a class="docs-heading-anchor-permalink" href="#Vector-Jacobian-products" title="Permalink"></a></h2><p>This operation goes by a few names, like &quot;pullback&quot;. Refer to the <a href="https://juliadiff.org/ChainRulesCore.jl/stable/#The-propagators:-pushforward-and-pullback">ChainRules documentation</a> for more on terminology. For a single input, single output function <code>f</code> with a Jacobian <code>J</code>, the pullback operator <code>pb_f</code> is equivalent to applying the function <code>v -&gt; v&#39; * J</code> on a (co-tangent) vector <code>v</code>.</p><p>The following functions can be used to request the pullback operator/function with or without the function value. In order to request the pullback function <code>pb_f</code> of a function <code>f</code> at the inputs <code>xs</code>, you can use either of:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.pullback_function" href="#AbstractDifferentiation.pullback_function"><code>AbstractDifferentiation.pullback_function</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.pullback_function(ab::AD.AbstractBackend, f, xs...)</code></pre><p>Return the pullback function <code>pbf</code> of the function <code>f</code> at the inputs <code>xs</code> using backend <code>ab</code>. </p><p>The pullback function <code>pbf</code> accepts as input a <code>Tuple</code> of cotangents, one for each output of <code>f</code>. If <code>f</code> has a single output, <code>pbf</code> can also accept a single input instead of a 1-tuple.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L308-L315">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.value_and_pullback_function" href="#AbstractDifferentiation.value_and_pullback_function"><code>AbstractDifferentiation.value_and_pullback_function</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.value_and_pullback_function(ab::AD.AbstractBackend, f, xs...)</code></pre><p>Return a tuple <code>(v, pbf)</code> of the function value <code>v = f(xs...)</code> and the pullback function <code>pbf = AD.pullback_function(ab, f, xs...)</code>.</p><p>See also <a href="#AbstractDifferentiation.pullback_function"><code>AbstractDifferentiation.pullback_function</code></a>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This name should be understood as &quot;value and (pullback function)&quot;, and thus is not aligned with the forward mode counterpart <a href="#AbstractDifferentiation.value_and_pushforward_function"><code>AbstractDifferentiation.value_and_pushforward_function</code></a>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L321-L330">source</a></section></article><h2 id="Lazy-operators"><a class="docs-heading-anchor" href="#Lazy-operators">Lazy operators</a><a id="Lazy-operators-1"></a><a class="docs-heading-anchor-permalink" href="#Lazy-operators" title="Permalink"></a></h2><p>You can also get a struct for the lazy derivative/gradient/Jacobian/Hessian of a function. You can then use the <code>*</code> operator to apply the lazy operator on a value or tuple of the correct shape. To get a lazy derivative/gradient/Jacobian/Hessian use any one of:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.lazy_derivative" href="#AbstractDifferentiation.lazy_derivative"><code>AbstractDifferentiation.lazy_derivative</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.lazy_derivative(ab::AbstractBackend, f, xs::Number...)</code></pre><p>Return an operator <code>ld</code> for multiplying by the derivative of <code>f</code> at <code>xs</code>.</p><p>You can apply the operator by multiplication e.g. <code>ld * y</code> where <code>y</code> is a number if <code>f</code> has a single input, a tuple of the same length as <code>xs</code> if <code>f</code> has multiple inputs, or an array of numbers/tuples.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L538-L544">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.lazy_gradient" href="#AbstractDifferentiation.lazy_gradient"><code>AbstractDifferentiation.lazy_gradient</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.lazy_gradient(ab::AbstractBackend, f, xs...)</code></pre><p>Return an operator <code>lg</code> for multiplying by the gradient of <code>f</code> at <code>xs</code>.</p><p>You can apply the operator by multiplication e.g. <code>lg * y</code> where <code>y</code> is a number if <code>f</code> has a single input or a tuple of the same length as <code>xs</code> if <code>f</code> has multiple inputs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L549-L555">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.lazy_jacobian" href="#AbstractDifferentiation.lazy_jacobian"><code>AbstractDifferentiation.lazy_jacobian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.lazy_jacobian(ab::AbstractBackend, f, xs...)</code></pre><p>Return an operator <code>lj</code> for multiplying by the Jacobian of <code>f</code> at <code>xs</code>.</p><p>You can apply the operator by multiplication e.g. <code>lj * y</code> or <code>y&#39; * lj</code> where <code>y</code> is a number, vector or tuple of numbers and/or vectors.  If <code>f</code> has multiple inputs, <code>y</code> in <code>lj * y</code> should be a tuple. If <code>f</code> has multiple outputs, <code>y</code> in <code>y&#39; * lj</code> should be a tuple. Otherwise, it should be a scalar or a vector of the appropriate length.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L571-L580">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AbstractDifferentiation.lazy_hessian" href="#AbstractDifferentiation.lazy_hessian"><code>AbstractDifferentiation.lazy_hessian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AD.lazy_hessian(ab::AbstractBackend, f, x)</code></pre><p>Return an operator <code>lh</code> for multiplying by the Hessian of the scalar-valued function <code>f</code> at <code>x</code>.</p><p>You can apply the operator by multiplication e.g. <code>lh * y</code> or <code>y&#39; * lh</code> where <code>y</code> is a number or a vector of the appropriate length.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/AbstractDifferentiation.jl/blob/462225bc7527b921505f827f8c882cf970eead69/src/AbstractDifferentiation.jl#L560-L566">source</a></section></article><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#AbstractDifferentiation.FiniteDifferencesBackend"><code>AbstractDifferentiation.FiniteDifferencesBackend</code></a></li><li><a href="#AbstractDifferentiation.ForwardDiffBackend"><code>AbstractDifferentiation.ForwardDiffBackend</code></a></li><li><a href="#AbstractDifferentiation.HigherOrderBackend"><code>AbstractDifferentiation.HigherOrderBackend</code></a></li><li><a href="#AbstractDifferentiation.ReverseDiffBackend"><code>AbstractDifferentiation.ReverseDiffBackend</code></a></li><li><a href="#AbstractDifferentiation.ReverseRuleConfigBackend"><code>AbstractDifferentiation.ReverseRuleConfigBackend</code></a></li><li><a href="#AbstractDifferentiation.TrackerBackend"><code>AbstractDifferentiation.TrackerBackend</code></a></li><li><a href="#AbstractDifferentiation.ZygoteBackend"><code>AbstractDifferentiation.ZygoteBackend</code></a></li><li><a href="#AbstractDifferentiation.derivative"><code>AbstractDifferentiation.derivative</code></a></li><li><a href="#AbstractDifferentiation.gradient"><code>AbstractDifferentiation.gradient</code></a></li><li><a href="#AbstractDifferentiation.hessian"><code>AbstractDifferentiation.hessian</code></a></li><li><a href="#AbstractDifferentiation.jacobian"><code>AbstractDifferentiation.jacobian</code></a></li><li><a href="#AbstractDifferentiation.lazy_derivative"><code>AbstractDifferentiation.lazy_derivative</code></a></li><li><a href="#AbstractDifferentiation.lazy_gradient"><code>AbstractDifferentiation.lazy_gradient</code></a></li><li><a href="#AbstractDifferentiation.lazy_hessian"><code>AbstractDifferentiation.lazy_hessian</code></a></li><li><a href="#AbstractDifferentiation.lazy_jacobian"><code>AbstractDifferentiation.lazy_jacobian</code></a></li><li><a href="#AbstractDifferentiation.pullback_function"><code>AbstractDifferentiation.pullback_function</code></a></li><li><a href="#AbstractDifferentiation.pushforward_function"><code>AbstractDifferentiation.pushforward_function</code></a></li><li><a href="#AbstractDifferentiation.second_derivative"><code>AbstractDifferentiation.second_derivative</code></a></li><li><a href="#AbstractDifferentiation.value_and_derivative"><code>AbstractDifferentiation.value_and_derivative</code></a></li><li><a href="#AbstractDifferentiation.value_and_gradient"><code>AbstractDifferentiation.value_and_gradient</code></a></li><li><a href="#AbstractDifferentiation.value_and_hessian"><code>AbstractDifferentiation.value_and_hessian</code></a></li><li><a href="#AbstractDifferentiation.value_and_jacobian"><code>AbstractDifferentiation.value_and_jacobian</code></a></li><li><a href="#AbstractDifferentiation.value_and_pullback_function"><code>AbstractDifferentiation.value_and_pullback_function</code></a></li><li><a href="#AbstractDifferentiation.value_and_pushforward_function"><code>AbstractDifferentiation.value_and_pushforward_function</code></a></li><li><a href="#AbstractDifferentiation.value_and_second_derivative"><code>AbstractDifferentiation.value_and_second_derivative</code></a></li><li><a href="#AbstractDifferentiation.value_derivative_and_second_derivative"><code>AbstractDifferentiation.value_derivative_and_second_derivative</code></a></li><li><a href="#AbstractDifferentiation.value_gradient_and_hessian"><code>AbstractDifferentiation.value_gradient_and_hessian</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../implementer_guide/">Implementer guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Monday 5 February 2024 12:18">Monday 5 February 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
